<div class="dashboard-container">
    <div class="page-header">
        <div class="header-content">
            <h1>Dashboard Manager</h1>
            <p>Vue d'ensemble complète de votre équipe et des activités</p>
        </div>
    </div>

    @if (errorMessage()) {
    <div class="alert alert-error">
        <span>! {{ errorMessage() }}</span>
        <button (click)="errorMessage.set(null)">X</button>
    </div>
    }

    @if (loading()) {
    <div class="loading-state">
        <div class="spinner"></div>
        <p>Chargement des statistiques...</p>
    </div>
    } @else if (stats()) {

    <!-- KPI Cards Grid -->
    <div class="stats-grid">
        <!-- Carte: Équipe -->
        <div class="stat-card team-card">
            <div class="card-header">
                <div class="stat-icon">T</div>
                <div class="stat-badge">Équipe</div>
            </div>
            <div class="stat-content">
                <div class="stat-value">{{ stats()!.nombreEmployes }}</div>
                <div class="stat-label">Membres actifs</div>
            </div>
            <div class="card-footer">
                <button class="quick-link" [routerLink]="['/manager/team']">
                    Voir l'équipe →
                </button>
            </div>
        </div>

        <!-- Carte: Niveau moyen -->
        <div class="stat-card level-card">
            <div class="card-header">
                <div class="stat-icon">P</div>
                <div class="stat-badge">Performance</div>
            </div>
            <div class="stat-content">
                <div class="stat-value">{{ stats()!.niveauMoyenEquipe | number:'1.0-1' }}<span class="unit">%</span>
                </div>
                <div class="stat-label">Niveau moyen</div>
            </div>
            <div class="progress-bar">
                <div class="progress-fill" [style.width.%]="stats()!.niveauMoyenEquipe"></div>
            </div>
        </div>

        <!-- Carte: Évaluations en attente -->
        <div class="stat-card eval-card clickable" [routerLink]="['/manager/evaluations']">
            <div class="card-header">
                <div class="stat-icon">E</div>
                <div class="stat-badge pending">En attente</div>
            </div>
            <div class="stat-content">
                <div class="stat-value">{{ stats()!.evaluationsEnAttente }}</div>
                <div class="stat-label">Évaluations</div>
            </div>
            <div class="card-footer">
                <span class="action-hint">Cliquez pour évaluer →</span>
            </div>
        </div>

        <!-- Carte: Tests en cours -->
        <div class="stat-card tests-card">
            <div class="card-header">
                <div class="stat-icon">T</div>
                <div class="stat-badge">Tests</div>
            </div>
            <div class="stat-content">
                <div class="stat-value">{{ stats()!.testsEnCours }}</div>
                <div class="stat-label">Tests actifs</div>
            </div>
        </div>

        <!-- Carte: Projets actifs -->
        <div class="stat-card projects-card">
            <div class="card-header">
                <div class="stat-icon">P</div>
                <div class="stat-badge">Projets</div>
            </div>
            <div class="stat-content">
                <div class="stat-value">{{ stats()!.projetsActifs }}</div>
                <div class="stat-label">Projets en cours</div>
            </div>
        </div>
    </div>

    <!-- Compétences Section -->
    <div class="competences-section">
        <div class="section-header">
            <h2>Analyse des Compétences</h2>
            <p>Forces et axes d'amélioration de votre équipe</p>
        </div>

        <div class="competences-grid">
            <!-- Compétences fortes -->
            <div class="competences-card strong-skills">
                <div class="card-icon">+</div>
                <h3>Compétences fortes</h3>
                @if (stats()!.competencesFortes.length > 0) {
                <div class="competences-list">
                    @for (comp of stats()!.competencesFortes; track comp) {
                    <span class="skill-badge success">{{ comp }}</span>
                    }
                </div>
                } @else {
                <p class="empty-message">Aucune compétence forte identifiée pour le moment</p>
                }
            </div>

            <!-- Compétences à renforcer -->
            <div class="competences-card weak-skills">
                <div class="card-icon">!</div>
                <h3>À renforcer</h3>
                @if (stats()!.competencesFaibles.length > 0) {
                <div class="competences-list">
                    @for (comp of stats()!.competencesFaibles; track comp) {
                    <span class="skill-badge warning">{{ comp }}</span>
                    }
                </div>
                } @else {
                <p class="empty-message">Aucune faiblesse identifiée - Excellent travail!</p>
                }
            </div>
        </div>
    </div>

    <!-- Actions rapides -->
    <div class="quick-actions-section">
        <div class="section-header">
            <h2>Actions Rapides</h2>
            <p>Accès direct aux fonctionnalités principales</p>
        </div>

        <div class="actions-grid">
            <button class="action-card" [routerLink]="['/manager/team']">
                <div class="action-icon">T</div>
                <div class="action-content">
                    <h4>Mon Équipe</h4>
                    <p>Gérer les membres</p>
                </div>
                <div class="action-arrow">→</div>
            </button>

            <button class="action-card highlight" [routerLink]="['/manager/evaluations']">
                <div class="action-icon">E</div>
                <div class="action-content">
                    <h4>Évaluer</h4>
                    <p>Valider les compétences</p>
                </div>
                @if (stats()!.evaluationsEnAttente > 0) {
                <div class="action-badge">{{ stats()!.evaluationsEnAttente }}</div>
                }
                <div class="action-arrow">→</div>
            </button>

            <button class="action-card" [routerLink]="['/manager/tests']">
                <div class="action-icon">T</div>
                <div class="action-content">
                    <h4>Tests</h4>
                    <p>Assigner et suivre</p>
                </div>
                <div class="action-arrow">→</div>
            </button>

            <button class="action-card" [routerLink]="['/manager/projects']">
                <div class="action-icon">P</div>
                <div class="action-content">
                    <h4>Projets</h4>
                    <p>Gérer les affectations</p>
                </div>
                <div class="action-arrow">→</div>
            </button>
        </div>
    </div>
    }
</div>