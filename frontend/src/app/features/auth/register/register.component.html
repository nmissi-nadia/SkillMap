<div class="auth-shell">

    <!-- PANNEAU GAUCHE : visuel immersif -->
    <div class="hero-panel">
        <svg class="network-svg" viewBox="0 0 600 700" preserveAspectRatio="xMidYMid slice"
            xmlns="http://www.w3.org/2000/svg">
            <g class="edges" stroke="rgba(167,139,250,0.3)" stroke-width="1">
                <line x1="120" y1="80" x2="300" y2="180" class="edge e1" />
                <line x1="300" y1="180" x2="480" y2="100" class="edge e2" />
                <line x1="300" y1="180" x2="200" y2="350" class="edge e3" />
                <line x1="200" y1="350" x2="400" y2="320" class="edge e4" />
                <line x1="400" y1="320" x2="480" y2="100" class="edge e5" />
                <line x1="200" y1="350" x2="100" y2="500" class="edge e6" />
                <line x1="400" y1="320" x2="500" y2="480" class="edge e7" />
                <line x1="100" y1="500" x2="300" y2="580" class="edge e8" />
                <line x1="500" y1="480" x2="300" y2="580" class="edge e9" />
                <line x1="120" y1="80" x2="200" y2="350" class="edge e10" />
                <line x1="480" y1="100" x2="500" y2="480" class="edge e11" />
                <line x1="300" y1="180" x2="300" y2="580" class="edge e12" />
            </g>
            <g class="nodes">
                <circle cx="120" cy="80" r="8" class="node n1" fill="#a78bfa" />
                <circle cx="300" cy="180" r="14" class="node n2" fill="#7c3aed" />
                <circle cx="480" cy="100" r="8" class="node n3" fill="#06b6d4" />
                <circle cx="200" cy="350" r="11" class="node n4" fill="#a78bfa" />
                <circle cx="400" cy="320" r="10" class="node n5" fill="#818cf8" />
                <circle cx="100" cy="500" r="7" class="node n6" fill="#c4b5fd" />
                <circle cx="500" cy="480" r="9" class="node n7" fill="#06b6d4" />
                <circle cx="300" cy="580" r="12" class="node n8" fill="#7c3aed" />
                <circle cx="300" cy="180" r="26" fill="rgba(124,58,237,0.12)" class="halo" />
                <circle cx="300" cy="580" r="22" fill="rgba(124,58,237,0.12)" class="halo" />
            </g>
        </svg>

        <div class="orb orb-1"></div>
        <div class="orb orb-2"></div>
        <div class="orb orb-3"></div>

        <div class="hero-content">
            <div class="hero-logo">
                <svg width="44" height="44" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
                    <polygon
                        points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2" />
                </svg>
            </div>
            <h2 class="hero-title">SkillMap</h2>
            <p class="hero-subtitle">Rejoignez la plateforme de<br>gestion intelligente des talents</p>

            <div class="hero-features">
                <div class="feature">
                    <span class="feature-dot"></span>
                    Profil compétences personnalisé
                </div>
                <div class="feature">
                    <span class="feature-dot"></span>
                    Matching avec les meilleures opportunités
                </div>
                <div class="feature">
                    <span class="feature-dot"></span>
                    Suivi de progression et formations
                </div>
            </div>
        </div>
    </div>

    <!-- PANNEAU DROIT : formulaire -->
    <div class="form-panel">
        <div class="form-card">
            <div class="form-header">
                <div class="form-logo-sm">SK</div>
                <h1>Créer un compte</h1>
                <p>Rejoignez SkillMap en quelques secondes</p>
            </div>

            @if (errorMessage()) {
            <div class="error-alert">
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none"
                    stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10" />
                    <line x1="12" y1="8" x2="12" y2="12" />
                    <line x1="12" y1="16" x2="12.01" y2="16" />
                </svg>
                <span>{{ errorMessage() }}</span>
            </div>
            }

            <form [formGroup]="registerForm" (ngSubmit)="onSubmit()" class="register-form">

                <!-- Nom + Prénom -->
                <div class="form-row">
                    <div class="form-group">
                        <label for="nom">
                            <svg width="13" height="13" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2">
                                <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2" />
                                <circle cx="12" cy="7" r="4" />
                            </svg>
                            Nom
                        </label>
                        <input type="text" id="nom" formControlName="nom" placeholder="Dupont"
                            [class.invalid]="nom?.invalid && nom?.touched" />
                        @if (nom?.invalid && nom?.touched) {
                        <div class="error-message">
                            @if (nom?.errors?.['required']) { <span>Requis</span> }
                            @if (nom?.errors?.['minlength']) { <span>2 caractères min.</span> }
                        </div>
                        }
                    </div>

                    <div class="form-group">
                        <label for="prenom">Prénom</label>
                        <input type="text" id="prenom" formControlName="prenom" placeholder="Jean"
                            [class.invalid]="prenom?.invalid && prenom?.touched" />
                        @if (prenom?.invalid && prenom?.touched) {
                        <div class="error-message">
                            @if (prenom?.errors?.['required']) { <span>Requis</span> }
                            @if (prenom?.errors?.['minlength']) { <span>2 caractères min.</span> }
                        </div>
                        }
                    </div>
                </div>

                <!-- Email -->
                <div class="form-group">
                    <label for="email">
                        <svg width="13" height="13" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z" />
                            <polyline points="22,6 12,13 2,6" />
                        </svg>
                        Adresse email
                    </label>
                    <input type="email" id="email" formControlName="email" placeholder="jean.dupont@exemple.com"
                        [class.invalid]="email?.invalid && email?.touched" />
                    @if (email?.invalid && email?.touched) {
                    <div class="error-message">
                        @if (email?.errors?.['required']) { <span>L'email est requis</span> }
                        @if (email?.errors?.['email']) { <span>Format invalide</span> }
                    </div>
                    }
                </div>

                <!-- Rôle -->
                <div class="form-group">
                    <label for="role">
                        <svg width="13" height="13" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <rect x="2" y="7" width="20" height="14" rx="2" />
                            <path d="M16 7V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v2" />
                        </svg>
                        Rôle
                    </label>
                    <select id="role" formControlName="role" [class.invalid]="role?.invalid && role?.touched">
                        @for (roleValue of roles; track roleValue) {
                        <option [value]="roleValue">{{ roleLabels[roleValue] }}</option>
                        }
                    </select>
                    @if (role?.invalid && role?.touched) {
                    <div class="error-message"><span>Le rôle est requis</span></div>
                    }
                </div>

                <!-- Mot de passe -->
                <div class="form-row">
                    <div class="form-group">
                        <label for="password">
                            <svg width="13" height="13" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2">
                                <rect x="3" y="11" width="18" height="11" rx="2" ry="2" />
                                <path d="M7 11V7a5 5 0 0 1 10 0v4" />
                            </svg>
                            Mot de passe
                        </label>
                        <input type="password" id="password" formControlName="password" placeholder="••••••••"
                            [class.invalid]="password?.invalid && password?.touched" />
                        @if (password?.invalid && password?.touched) {
                        <div class="error-message">
                            @if (password?.errors?.['required']) { <span>Requis</span> }
                            @if (password?.errors?.['minlength']) { <span>6 caractères min.</span> }
                        </div>
                        }
                    </div>

                    <div class="form-group">
                        <label for="confirmPassword">Confirmer</label>
                        <input type="password" id="confirmPassword" formControlName="confirmPassword"
                            placeholder="••••••••"
                            [class.invalid]="(confirmPassword?.invalid && confirmPassword?.touched) || (!passwordsMatch && confirmPassword?.touched)" />
                        @if (confirmPassword?.invalid && confirmPassword?.touched) {
                        <div class="error-message">
                            @if (confirmPassword?.errors?.['required']) { <span>Requis</span> }
                        </div>
                        }
                        @if (!passwordsMatch && confirmPassword?.touched && confirmPassword?.value) {
                        <div class="error-message"><span>Ne correspondent pas</span></div>
                        }
                    </div>
                </div>

                <!-- Indicateur de force du mot de passe -->
                @if (password?.value) {
                <div class="password-strength">
                    <div class="strength-bars">
                        <div class="bar" [class.active]="passwordStrength >= 1" [class.weak]="passwordStrength === 1">
                        </div>
                        <div class="bar" [class.active]="passwordStrength >= 2" [class.fair]="passwordStrength === 2">
                        </div>
                        <div class="bar" [class.active]="passwordStrength >= 3" [class.good]="passwordStrength === 3">
                        </div>
                        <div class="bar" [class.active]="passwordStrength >= 4" [class.strong]="passwordStrength >= 4">
                        </div>
                    </div>
                    <span class="strength-label">{{ strengthLabel }}</span>
                </div>
                }

                <button type="submit" class="submit-btn" [disabled]="isLoading()">
                    @if (isLoading()) {
                    <span class="spinner"></span>
                    <span>Inscription en cours…</span>
                    } @else {
                    <span>Créer mon compte</span>
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="5" y1="12" x2="19" y2="12" />
                        <polyline points="12 5 19 12 12 19" />
                    </svg>
                    }
                </button>
            </form>

            <div class="form-footer">
                <p>Déjà un compte ?
                    <a routerLink="/login">Se connecter</a>
                </p>
            </div>
        </div>
    </div>

</div>